<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8"/>
	<meta name="viewport" content="width=device-width, initial-scale=1">

	<!-- fonts -->
		<link href="https://fonts.googleapis.com/css?family=Barlow+Condensed" rel="stylesheet">
		
		<link rel="stylesheet" type="text/css" href="libraries/bootstrap-3.3.7/css/bootstrap.css">
		
		<!-- Awesome fonts -->
    	<link  rel="stylesheet" href="libraries/font-awesome-4.5.0/css/font-awesome.css">
    	
		<link rel="stylesheet" type="text/css" href="resources/css/sabine-poel.css">
		
		<script type="text/javascript" src="libraries/jquery-3.2.1/jquery.js"></script>
		<script type="text/javascript" src="libraries/bootstrap-3.3.7/js/bootstrap.js"></script>
		<script type="text/javascript" src="libraries/mustache-2.3.0/mustache.js"></script>
		
		<script type="text/javascript" src="resources/javascript/sabine.js"></script>
</head>

<body class="not-home">

	<script id="sabine-person-template" type="text/template">
			<div class="person">
				<div class="form-group">
					<label for="organisation-name" class="col-sm-4 control-label">Voornaam en familienaam (*)</label>
					<div class="col-sm-3">	
						<input type="text" class="form-control input-name" required="required"></input>
					</div>
				</div>
				<div class="form-group">
						<label for="organisation-telefoon" class="col-sm-4 control-label">Telefoonnummer</label>
						<div class="col-sm-2">
							<input type="tel" class="form-control input-telephone"></input>
						</div>
				</div>
				<div class="form-group">
						<label for="organisation-email" class="col-sm-4 control-label">E-mail (*)</label>
						<div class="col-sm-3">
							<input type="email" class="form-control input-email" required="required" value=""></input>
						</div>
				</div>
				<br/>
			</div>
	</script>
	
	<header>
		<nav class="navbar navbar-default sabine-navbar">
		<div class="container-fluid">
			  <div class="navbar-header">
	      		<button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar-collapse" aria-expanded="false">
	        		<span class="sr-only">Toggle navigation</span>
	        		<span class="icon-bar"></span>
	        		<span class="icon-bar"></span>
	        		<span class="icon-bar"></span>
	      		</button>
	    	  </div>
			  <div class="navbar-collapse collapse" id="navbar-collapse">
			  	<ul class="nav navbar-nav navbar-right">
			  		<li class="nav-item sabine-nav-link"> <a href="sabine.html">Sabine</a> </li>
			  		<li class="nav-item sabine-nav-link"> <a href="bemiddeling.html">Bemiddeling</a> </li> 
			  		<li class="nav-item sabine-nav-link"> <a href="eot.html">EOT</a> </li>
			  		<li class="nav-item sabine-nav-link"> <a href="links.html">Links</a> </li>
			  		<li class="nav-item sabine-nav-link"> <a href="tarieven.html">Tarieven</a> </li>
		  			<li class="nav-item sabine-nav-button"> <a href="afspraak.html">Afspraak</a> </li>
		  		</ul>
	  		</div>
  		</div>
		</nav>
	</header>

	<section id="sabine-afspraak" class="sabine-content-section">
	
		<article id="sabine-entry-form">
			
			<h1>Afspraak</h1>
		
			<p>
					Een afspraak maken kan per telefoon, e-mail of via onderstaand formulier.
			</p>
			
			<p class="info">
					Velden met een (*) moet je zeker invullen.
			</p>
			
			<p class="info">
				Vul de gegevens in van alle personen die betrokken zijn bij de bemiddeling (minstens 2).
			</p>
			
			<p class="info">
				Na ontvangst van het formulier contacteer ik u zo snel mogelijk per e-mail.
			</p>
			
			<p class="info">
				Wil je je niet aanmelden voor een bemiddelingsgesprek maar voor psychologische hulp, gelieve u dan aan te melden via <a href="http://www.groepspraktijkacsi.be">www.groepspraktijkacsi.be</a> - afspraak - webformulier. 
			</p>
			
			<div class="well">
				<span>Ik wil een afspraak maken voor:</span>
				<form id="selectForm" class="form-horizontal" role="form" method="post">
					<div class="radio">
	  					<label>
	    					<input type="radio" name="pick" value="multiple">
	    						bemiddeling
	  					</label>
					</div>
					<div class="radio">
					  <label>
					    <input type="radio" name="pick" value="single">
					    	gesprek als ouder-plusouder-grootouder
					  </label>
					</div>
				</form>
			</div>
		
			<form id="multipleForm" class="form-horizontal hidden" role="form" method="post" enctype="application/x-www-form-urlencoded" accept-charset="utf-8">
				
				<br/>
				
				<input name="reason" type="hidden" value="bemiddeling"/>
				
				<div id="sabine-persons">
				</div>
				
				<div class="form-group">
						<label for="organisation-email" class="col-sm-4 control-label"></label>
						<div class="col-sm-3">
							<button type="button" id="sabine-add-person" class="btn btn-primary"><i class="fa fa-plus"></i></button></button>
						</div>
				</div>
				
				<div class="form-group">
					<label class="col-sm-4 control-label">Verwerking gegevens (*)</label>
					<div class="col-sm-8">
						<input type="checkbox" required="required">&nbsp;Ik ben akkoord dat de gegevens van dit formulier verwerkt en gebruikt worden zoals aangegeven in de <a href="resources/files/gdpr-sabine-poel.pdf">privacy-verklaring</a>.
					</div>
				</div>
				 
				<div class="form-group">
					<label class="col-sm-4 control-label"></label>
					<div class="col-sm-8">
						<button type="submit" id="submitMultiple" class="btn btn-primary"><i class="fa fa-save"></i>&nbsp;&nbsp;Verstuur</button>
					</div>
				</div>
				<div class="form-group">
					<label class="col-sm-4 control-label"></label>
					<div class="col-sm-8">
						<div id="submitStatusMultiple" class="hidden"></div>
					</div>
				</div>
				
			</form>
			
			<form id="singleForm" class="form-horizontal hidden" role="form" method="post" enctype="application/x-www-form-urlencoded" accept-charset="utf-8">
				
				<br/>
				
				<input name="reason" type="hidden" value="gesprek"/>
				
				<div id="sabine-person">
				</div>
				
				<div class="form-group">
						<label for="description" class="col-sm-4 control-label">Korte uitleg</label>
						<div class="col-sm-8">
							<textarea name="description" class="form-control" rows="10" cols="64"></textarea>
						</div>
				</div>
				
				<div class="form-group">
					<label class="col-sm-4 control-label">Verwerking gegevens (*)</label>
					<div class="col-sm-8">
						<input type="checkbox" required="required">&nbsp;Ik ben akkoord dat de gegevens van dit formulier verwerkt en gebruikt worden zoals aangegeven in de <a href="resources/files/gdpr-sabine-poel.pdf">privacy-verklaring</a>.
					</div>
				</div>
				 
				<div class="form-group">
					<label class="col-sm-4 control-label"></label>
					<div class="col-sm-8">
						<button type="submit" id="submitSingle" class="btn btn-primary"><i class="fa fa-save"></i>&nbsp;&nbsp;Verstuur</button>
					</div>
				</div>
				<div class="form-group">
					<label class="col-sm-4 control-label"></label>
					<div class="col-sm-8">
						<div id="submitStatusSingle" class="hidden"></div>
					</div>
				</div>
				
			</form>
		
		</article>
		
		
	
	</section>
	

		
	<footer class="footer-not-home">
		<a class="footer-data" href="mailto:sabinepoel@gmail.com">sabinepoel@gmail.com</a>
		<a class="footer-data" href="tel:+32484767380">0484/76.73.80</a>
		<a class="footer-data" href="">Houwaartstraat 114, 3210 Linden (Lubbeek)</a>
	</footer>
			
</body>
	
	<script>
		var $jq = jQuery.noConflict();
		
		$jq("#sabine-add-person").click( function() {
	    	
			addPerson();
			
	    });
		
		var addPerson = function(container) {
			
			var template = $jq("#sabine-person-template").html();
			var html = Mustache.to_html(template);
			container.append( html );
			
	        return false;
			
		};
		
		var serialize = function( element ) {
		    var o = {};
		    var a = element.serializeArray();
		    $jq.each(a, function() {
		        if (o[this.name] !== undefined) {
		            if (!o[this.name].push) {
		                o[this.name] = [o[this.name]];
		            }
		            o[this.name].push(this.value || '');
		        } else {
		            o[this.name] = this.value || '';
		        }
		    });
		    return o;
		};
		
		var serializePersons = function( elements ) {
		    var o = new Array();
		    $jq.each(elements, function() {
		    	var name = $jq(this).find(".input-name").val();
		    	var email = $jq(this).find(".input-email").val();
		    	var telephone = $jq(this).find(".input-telephone").val();
		    	var person = new Person(name,email,telephone);
		       	o.push( person );
		    });
		    return o;
		};
		
		var Person = function (name,email,telephone) {
			this.name = name;
			this.email = email;
			this.telephone = telephone;
		};
		
	$jq("input[type=radio][name=pick]").on("change", function() {
			  switch ($jq(this).val()) {
			    case "single":
			      $jq("#sabine-person").html("");
			      addPerson( $jq("#sabine-person") );
			      $jq("#singleForm").removeClass("hidden");
			      $jq("#multipleForm").addClass("hidden");
			      break;
			    case 'multiple':
			    	$jq("#sabine-persons").html("");
			       addPerson( $jq("#sabine-persons") );
			       addPerson( $jq("#sabine-persons") );
				   $jq("#multipleForm").removeClass("hidden");
				   $jq("#singleForm").addClass("hidden");
				   break;
			  }
	});
		
	$jq("#singleForm").submit( function( event ) {
			
			event.preventDefault();
			
			var type = "json";

			var url = "${sabine-poel.backend}/api/entries";

			var fdata 
				= new FormData();
		
			var serializedForm
				= serialize( $jq("#singleForm") )
				
			var serializedPersons
				= serializePersons( $jq(".person") );
			
			serializedForm["persons"] = serializedPersons;

			var json 
				= JSON.stringify( serializedForm );
			
			busyButton($jq("#submitSingle"));

			$jq.ajax({
				type : "post",
				url : url,
				dataType : type,
				contentType : "application/json",
				processData : false,
				data : json,
				success : function( created ) {
					succession( $jq("#submitSingle"), $jq("#submitStatusSingle"), "Je aanvraag werd met succes verstuurd. U hoort snel iets van me." );
				},
				error : function( response ) {
					errore($jq("#submitSingle"), $jq("#submitStatusSingle"), "Er trad een fout op. Probeer AUB opnieuw." );
				}
			});
			
		});
		
		$jq("#multipleForm").submit( function( event ) {
			
			event.preventDefault();
			
			var type = "json";

			var url = "${sabine-poel.backend}/api/entries";

			var fdata 
				= new FormData();
		
			var serializedForm
				= serialize( $jq("#multipleForm") )
				
			var serializedPersons
				= serializePersons( $jq(".person") );
			
			serializedForm["persons"] = serializedPersons;

			var json 
				= JSON.stringify( serializedForm );
			
			busyButton($jq("#submitMultiple"));

			$jq.ajax({
				type : "post",
				url : url,
				dataType : type,
				contentType : "application/json",
				processData : false,
				data : json,
				success : function( created ) {
					succession( $jq("#submitMultiple"), $jq("#submitStatusMultiple"), "Je aanvraag werd met succes verstuurd. U hoort snel iets van me." );
				},
				error : function( response ) {
					errore($jq("#submitMultiple"), $jq("#submitStatusMultiple"), "Er trad een fout op. Probeer AUB opnieuw." );
				}
			});
			
		});
		
		$jq(document).ready(function($jq){
			
		    
	});
	</script>
	
</body>

</html>
